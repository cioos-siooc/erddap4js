!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define([],e):"object"==typeof exports?exports.ERDDAP=e():t.ERDDAP=e()}(window,(function(){return function(t){var e={};function r(n){if(e[n])return e[n].exports;var o=e[n]={i:n,l:!1,exports:{}};return t[n].call(o.exports,o,o.exports,r),o.l=!0,o.exports}return r.m=t,r.c=e,r.d=function(t,e,n){r.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},r.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},r.t=function(t,e){if(1&e&&(t=r(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var o in t)r.d(n,o,function(e){return t[e]}.bind(null,o));return n},r.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return r.d(e,"a",e),e},r.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},r.p="",r(r.s=1)}([function(t,e,r){"use strict";var n=function(){if("undefined"!=typeof self)return self;if("undefined"!=typeof window)return window;if(void 0!==n)return n;throw new Error("unable to locate global object")}();t.exports=e=n.fetch,e.default=n.fetch.bind(n),e.Headers=n.Headers,e.Request=n.Request,e.Response=n.Response},function(t,e,r){"use strict";r.r(e);var n=r(0),o=r.n(n);function i(t){if(!t)throw new Error("Must supply options object");var e=t.dataset,r=t.variables;if(!e)throw new Error("Missing dataset");var n=["time","altitude","depth","lat","long"].map((function(e){var r=t[e]||[];if(r.length&&r.length<2)throw new Error('Must supply Start and Stop for dimension "'+e+'". eg "depth: [1,2]"');var n=r[0],o=r[1],i=r[2];if(n&&o)return"[("+n+"):"+(i||1)+":("+o+")]"})).filter((function(t){return t}));if(!n.length)throw new Error("Must filter on at least one dimension.");return"/griddap/"+e+".json?"+r.map((function(t){return t+""+n.join("")})).join()}var u=["!=","=~","<=",">=","=","<",">"];function a(t){var e=t.dataset,r=t.variables,n=void 0===r?[]:r,o=t.constraints,i=void 0===o?[]:o,a=t.distinct,s=t.orderType,f=t.orderVariables,c=void 0===f?[]:f,l=["orderBy","orderByClosest","orderByCount","orderByLimit","orderByMax","orderByMin","orderByMinMax","orderByMean"];if(!e)throw new Error("Missing dataset");if(s){if(!l.includes(s))throw new Error("Order type given was '"+s+"'. It must be one of: "+l);if(!c.length)throw new Error("At least one variable must be given to order by")}i.forEach((function(t){var e=t[0],r=t[1],n=t[2];if(!u.includes(r))throw new Error("Invalid operator: '"+r+"'. Must be one of: '"+u+"'");switch(e){case"time":break;case"latitude":case"longitude":if(Math.abs(n)>180)throw new Error("Invalid lat/long: "+n);break;case"depth":case"altitude":if(NaN==parseFloat(n))throw new Error("Invalid depth/altitude: "+n)}}));var d="/tabledap/"+e+".json",p=[];return n.length&&p.push(n.join()),i.length&&p.push(i.map((function(t){return t.join("")})).join("&")),a&&p.push("distinct()"),s&&c&&p.push(s+"("+c.join()+")"),p.length&&(d+="?"+(n.length?"":"&")+p.join("&")),d}var s=function(t,e,r,n){return new(r||(r=Promise))((function(o,i){function u(t){try{s(n.next(t))}catch(t){i(t)}}function a(t){try{s(n.throw(t))}catch(t){i(t)}}function s(t){var e;t.done?o(t.value):(e=t.value,e instanceof r?e:new r((function(t){t(e)}))).then(u,a)}s((n=n.apply(t,e||[])).next())}))},f=function(t,e){var r,n,o,i,u={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function a(i){return function(a){return function(i){if(r)throw new TypeError("Generator is already executing.");for(;u;)try{if(r=1,n&&(o=2&i[0]?n.return:i[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,i[1])).done)return o;switch(n=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return u.label++,{value:i[1],done:!1};case 5:u.label++,n=i[1],i=[0];continue;case 7:i=u.ops.pop(),u.trys.pop();continue;default:if(!(o=u.trys,(o=o.length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){u=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){u.label=i[1];break}if(6===i[0]&&u.label<o[1]){u.label=o[1],o=i;break}if(o&&u.label<o[2]){u.label=o[2],u.ops.push(i);break}o[2]&&u.ops.pop(),u.trys.pop();continue}i=e.call(t,u)}catch(t){i=[6,t],n=0}finally{r=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,a])}}},c=function(){function t(e){this.serverURL=t.sanitizeERDDAPURL(e)}return t.sanitizeERDDAPURL=function(t){var e;if(!(null===(e=(t=t.replace(/\/$/,"")).match(/https?:\/\//))||void 0===e?void 0:e.length))throw new Error("URL Must start wih http or https");return t.endsWith("/erddap")||console.warn("URL doesn't end in /erddap, trying anyway: "+t),t},t.reshapeJSON=function(t){var e=t.table,r=e.columnNames;return e.rows.map((function(t){return t.reduce((function(t,e,n){return t[r[n]]=e,t}),{})}))},t.prototype.queryURL=function(e){return s(this,void 0,void 0,(function(){var r,n=this;return f(this,(function(i){return r=this.serverURL+e,[2,o()(r).then((function(e){return s(n,void 0,void 0,(function(){var n;return f(this,(function(o){switch(o.label){case 0:return e.ok?[3,2]:[4,e.text()];case 1:if(n=o.sent(),404==e.status&&n.includes("nRows = 0"))return[2,[]];throw new Error("HTTP "+e.status+" error fetching "+r+"\n"+t.errorParser(n)+"\n");case 2:return[2,e.json().then(t.reshapeJSON)]}}))}))}))]}))}))},t.prototype.tabledap=function(t){return s(this,void 0,void 0,(function(){return f(this,(function(e){return[2,this.queryURL(a(t))]}))}))},t.prototype.griddap=function(t){return s(this,void 0,void 0,(function(){return f(this,(function(e){return[2,this.queryURL(i(t))]}))}))},t.errorParser=function(t){return(new RegExp(/message=\"(.*)\"/).exec(t)||[])[1]||t},t.prototype.info=function(t){return s(this,void 0,void 0,(function(){return f(this,(function(e){if(!t)throw new Error("Missing dataset ID");return[2,this.queryURL("/info/"+t+"/index.json")]}))}))},t.prototype.allDatasets=function(){return s(this,void 0,void 0,(function(){return f(this,(function(t){switch(t.label){case 0:return[4,this.queryURL("/tabledap/allDatasets.json")];case 1:return[2,t.sent().filter((function(t){return"allDatasets"!==t.dataset}))]}}))}))},t}();e.default=c}]).default}));